<!-- medication.wxml -->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-title">ç”¨è¯è®°å½•</view>
  
  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content-area">
    
    <!-- æ— ç”¨è¯è®¡åˆ’æç¤º -->
    <view wx:if="{{medicationPlans.length === 0}}" class="no-medications">
      <text class="no-medications-text">æš‚æ— ç”¨è¯è®¡åˆ’</text>
    </view>
    
    <!-- ç”¨è¯è®¡åˆ’åˆ—è¡¨ -->
    <view wx:else class="medication-plans-list">
      <!-- ç”¨è¯è®¡åˆ’å¡ç‰‡ -->
      <view wx:for="{{medicationPlans}}" wx:key="medicationPlansId" class="medication-plan-card">
        <!-- è®¡åˆ’å¤´éƒ¨ -->
        <view class="plan-header">
          <view class="plan-status" wx:if="{{item.isActive === '1'}}" style="color: #07c160;">ğŸŸ¢ å¯ç”¨ä¸­</view>
          <view class="plan-status" wx:else style="color: #ff4757;">ğŸ”´ å·²åœç”¨</view>
          <view class="plan-name">
            <text class="drug-name">{{item.drugName}}</text>
            <text class="nick-name">({{item.nickName}})</text>
          </view>
        </view>
        
        <!-- è®¡åˆ’è¯¦æƒ… -->
        <view class="plan-details">
          <view class="detail-item">
            <text class="detail-label">å‰‚é‡ï¼š</text>
            <text class="detail-value">{{item.dosage}}</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">æœç”¨é¢‘ç‡ï¼š</text>
            <text class="detail-value">{{item.frequency}}</text>
          </view>
          <view class="detail-item" wx:if="{{item.remark}}">
            <text class="detail-label">å¤‡æ³¨ï¼š</text>
            <text class="detail-value">{{item.remark}}</text>
          </view>
        </view>
        
        <!-- ç”¨è¯è®°å½• -->
        <view class="records-section">
          <view class="section-title">ç”¨è¯è®°å½•</view>
          
          <!-- æ— è®°å½•æç¤º -->
          <view wx:if="{{!item.records || item.records.length === 0}}" class="no-records">
            <text class="no-records-text">æš‚æ— ç”¨è¯è®°å½•</text>
          </view>
          
          <!-- è®°å½•åˆ—è¡¨ -->
          <view wx:else class="records-list">
            <view wx:for="{{item.records}}" wx:for-item="record" wx:key="medicationRecordId" class="record-item">
              <view class="record-time">{{record.time}}</view>
              <view class="record-content">
                <text class="record-remark">{{record.remark}}</text>
                <view class="record-meta">
                  <text class="record-creator">{{record.createBy}}</text>
                  <text class="record-create-time">{{record.createTime}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- åŠ è½½æ›´å¤šæç¤º -->
    <view wx:if="{{loading}}" class="loading-more">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
    
    <!-- æ²¡æœ‰æ›´å¤šæ•°æ®æç¤º -->
    <view wx:elif="{{!hasMore && medicationPlans.length > 0}}" class="no-more">
      <text class="no-more-text">æ²¡æœ‰æ›´å¤šæ•°æ®äº†</text>
    </view>
  </view>
  
  <!-- åº•éƒ¨è¿”å›æŒ‰é’® -->
  <view class="back-button-container">
    <button class="back-button" bindtap="navigateBack">è¿”å›é¦–é¡µ</button>
  </view>
</view>